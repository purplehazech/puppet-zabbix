rvm:
  - 1.8.7
  - 1.9.3
before_script:
  - source /etc/lsb-release
  - echo "deb http://ppa.launchpad.net/tbfr/zabbix/ubuntu $DISTRIB_CODENAME main" > zabbix.list
  - echo "deb-src http://ppa.launchpad.net/tbfr/zabbix/ubuntu $DISTRIB_CODENAME main" >> zabbix.list
  - sudo mv zabbix.list /etc/apt/sources.list.d/
  - sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C407E17D5F76A32B
  - sudo apt-get update -y
  - sudo apt-get install -y zabbix-server-mysql php5-mysql zabbix-frontend-php
  - mysql -u root -e "use zabbix; insert into users_groups(usrgrpid, userid) values(10,1);"
  - curl -fsSL https://raw.github.com/gist/8f0df0d1824ea25a3827/zabbix.php | sudo tee /usr/share/zabbix/conf/zabbix.conf.php
script:
  - "bundle exec rake lint"
  - "bundle exec rake spec"
env:
  - PUPPET_VERSION=3.0.1
  - PUPPET_VERSION=3.0.0
  - PUPPET_VERSION=2.7.18
  - PUPPET_VERSION=2.7.20
  - PUPPET_VERSION=2.7.13
  - PUPPET_VERSION=2.7.6
matrix:
  allow_failures:
    - env: 
      - PUPPET_VERSION=2.6.9
      - PUPPET_VERSION=2.7.6
      - PUPPET_VERSION=2.7.13
      - PUPPET_VERSION=2.7.18
      - PUPPET_VERSION=2.7.20
    - rvm: 1.9.3
